<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700&display=swap" rel="stylesheet">

<style>
    body{
        font-family: 'Tahoma', sans-serif;
        margin:0;
        padding:18px;
        background: linear-gradient(135deg, #eef2f3 0%, #dfe9f3 100%);
        min-height: 100vh;
        box-sizing:border-box;
    }

    .main-title{
        text-align:center;
        font-family: 'Cairo', sans-serif;
        font-size:32px;
        font-weight:700;
        color:#0051b2;
        margin-bottom:15px;
        letter-spacing:1px;
    }

    .announcement{
        width:100%;
        background: linear-gradient(90deg, #28a745, #5cb85c);
        padding:15px 20px;
        border-radius:12px;
        box-shadow: 0 0 20px rgba(40,168,69,0.5);
        color:white;
        font-family: 'Cairo', sans-serif;
        font-size:18px;
        font-weight:600;
        text-align:center;
        margin-bottom:25px;
        position: relative;
    }

    .announcement::before{
        content: "ğŸ“¢";
        position:absolute;
        left:15px;
        top:50%;
        transform:translateY(-50%);
        font-size:22px;
    }

    h3{
        text-align:center;
        margin-bottom:25px;
        color:#222;
        font-size:24px;
        font-family: 'Cairo', sans-serif;
        font-weight:700;
    }

    .instructions{
        background:white;
        padding:18px;
        border-radius:12px;
        box-shadow:0 3px 10px rgba(0,0,0,0.1);
        margin-bottom:25px;
        border-right:5px solid #007bff;
        line-height:1.9;
        font-size:17px;
        color:#333;
    }

    .offer-btn{
        background:#ffffff;
        color:#333;
        border:none;
        padding:16px;
        border-radius:12px;
        cursor:pointer;
        font-size:18px;
        width:100%;
        text-align:right;
        display:flex;
        justify-content:space-between;
        align-items:center;
        box-shadow:0 3px 8px rgba(0,0,0,0.1);
        transition:0.25s;
        margin-bottom:10px;
        font-family: 'Cairo', sans-serif;
        font-weight:600;
    }

    .offer-btn.active{
        background:#dbe8ff;
        color:#0051b2;
        font-weight:bold;
    }

    .arrow{ transition:0.3s; font-size:16px; }
    .arrow.rotate{ transform:rotate(90deg); }

    .offer-content{
        display: none;
        max-height: 0;
        overflow: hidden;
        background:white;
        border-radius:10px;
        border:1px solid #ddd;
        margin-top:4px;
        margin-bottom:12px;
        padding:0 15px;
        transition: max-height 0.35s ease, padding 0.25s ease;
        box-shadow:0 3px 8px rgba(0,0,0,0.06);
        font-family: 'Cairo', sans-serif;
    }

    .offer-content.show{
        display: block;
        padding:14px;
        max-height:300px;
    }

    input{
        width:100%;
        padding:13px;
        font-size:17px;
        margin-bottom:18px;
        border-radius:10px;
        border:1px solid #bbb;
        background:white;
        box-shadow:0px 2px 5px rgba(0,0,0,0.05);
    }

    button[type="submit"]{
        width:100%;
        background:#28a745;
        padding:16px;
        font-size:19px;
        color:white;
        border:none;
        border-radius:12px;
        cursor:pointer;
        box-shadow:0 3px 8px rgba(0,0,0,0.15);
        transition:0.2s;
        font-family: 'Cairo', sans-serif;
        font-weight:600;
    }

    /* ğŸ”¥ Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ */
    #blocker {
        position: fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:#000c;
        color:white;
        font-size:30px;
        font-family:'Cairo', sans-serif;
        display:flex;
        justify-content:center;
        align-items:center;
        z-index:99999;
        display:none;
        text-align:center;
        padding:20px;
    }
</style>
</head>

<body>

<div class="main-title">Ø¹Ø±ÙˆØ¶ Ø´Ø¨ÙƒØ© ØªÙˆØ§ØµÙ„</div>

<div class="announcement">
    Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† â€” Ø®Ø¯Ù…Ø© 24 Ø³Ø§Ø¹Ø©
</div>

<h3>Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</h3>

<div class="instructions">
    <b>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶:</b><br><br>
    1- Ù‚Ù… Ø¨Ø¥ÙŠØ¯Ø§Ø¹ Ù…Ø¨Ù„Øº Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ: <b>3011773906</b><br>
    2- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶ Ø«Ù… Ø£Ø¶Ù <b>Ø±Ù‚Ù… Ø§Ù„Ø¹Ø±Ø¶</b>.<br>
    3- Ø£Ø¶Ù Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³.<br>
    4- Ø£Ø¶Ù Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹ / Ø§Ù„Ø­ÙˆØ§Ù„Ø©.<br>
    5- Ø§Ø¶ØºØ· Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§Ù†ØªØ¸Ø± Ø±Ø¨Ø¹ Ø³Ø§Ø¹Ø© Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙƒØ±ÙˆØª.
</div>

<div id="offersArea">
    <button class="offer-btn" onclick="toggleOffer(event, 1)">
        Ø§Ù„Ø¹Ø±Ø¶ 1
        <span id="arrow1" class="arrow">â–¶</span>
    </button>
    <div id="offer1" class="offer-content">
        <div>Ø§ÙˆØ¯Ø¹ Ù…Ø¨Ù„Øº <b>2000 Ø±ÙŠØ§Ù„</b> ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 12 ÙƒØ±Øª ÙØ¦Ø© 200</div>
    </div>

    <button class="offer-btn" onclick="toggleOffer(event, 2)">
        Ø§Ù„Ø¹Ø±Ø¶ 2
        <span id="arrow2" class="arrow">â–¶</span>
    </button>
    <div id="offer2" class="offer-content">
        <div>Ø§ÙˆØ¯Ø¹ 3000 Ø±ÙŠØ§Ù„ â€” 11 ÙƒØ±Øª 300 + ÙƒØ±Øª 200</div>
    </div>

    <button class="offer-btn" onclick="toggleOffer(event, 3)">
        Ø§Ù„Ø¹Ø±Ø¶ 3
        <span id="arrow3" class="arrow">â–¶</span>
    </button>
    <div id="offer3" class="offer-content">
        <div>Ø§ÙˆØ¯Ø¹ 7000 Ø±ÙŠØ§Ù„ â€” Ø®Ø· 15 Ø¬ÙŠØ¬Ø§ Ù„Ù…Ø¯Ø© Ø´Ù‡Ø±</div>
    </div>
</div>

<form id="f">
<label>Ø±Ù‚Ù… Ø§Ù„Ø¹Ø±Ø¶:</label>
<input name="name" required type="tel">

<label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³:</label>
<input name="phone" required type="tel">

<label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹ / Ø§Ù„Ø­ÙˆØ§Ù„Ø©:</label>
<input name="ref" required type="tel">

<button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
</form>

<!-- ğŸ”¥ Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ -->
<div id="blocker">Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>

<script>
// ----------------------
// ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø±ÙˆØ¶
// ----------------------
let offers = {
    1: "Ø§ÙˆØ¯Ø¹ 2000 Ø±ÙŠØ§Ù„ â€” 12 ÙƒØ±Øª ÙØ¦Ø© 200",
    2: "Ø§ÙˆØ¯Ø¹ 3000 Ø±ÙŠØ§Ù„ â€” 11 ÙƒØ±Øª 300 + ÙƒØ±Øª 200",
    3: "Ø§ÙˆØ¯Ø¹ 7000 Ø±ÙŠØ§Ù„ â€” Ø®Ø· 15 Ø¬ÙŠØ¬Ø§ Ù„Ø´Ù‡Ø±"
};

let selectedOffer = "";

function toggleOffer(event, num){
    document.querySelectorAll(".offer-content").forEach((c, i) => {
        if(i + 1 !== num){
            c.classList.remove("show");
            c.style.display = "none";
        }
    });

    let box = document.getElementById("offer" + num);
    let btn = event.currentTarget;
    let arrow = document.getElementById("arrow" + num);

    if(!box.classList.contains("show")){
        box.style.display = "block";
        box.classList.add("show");
        btn.classList.add("active");
        arrow.classList.add("rotate");
        selectedOffer = offers[num];
    } else {
        box.classList.remove("show");
        box.style.display = "none";
        btn.classList.remove("active");
        arrow.classList.remove("rotate");
        selectedOffer = "";
    }
}

// ----------------------
// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
// ----------------------
document.getElementById("f").onsubmit = function(e){
    e.preventDefault();
    let f = new FormData(this);

    fetch("/pay", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
            name: f.get("name"),
            phone: f.get("phone"),
            ref: f.get("ref"),
            offer: selectedOffer
        })
    })
    .then(r => r.json())
    .then(data => {
        if(data.ok){
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
            this.reset();
        } else {
            alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
        }
    });
};

// ----------------------
// ğŸ”¥ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
// ----------------------
function checkStatus(){
    fetch("/status")
    .then(r => r.json())
    .then(data => {
        if(data.status === "closed"){
            document.getElementById("blocker").style.display = "flex";
        } else {
            document.getElementById("blocker").style.display = "none";
        }
    });
}

checkStatus();
setInterval(checkStatus, 3000);
</script>

</body>
</html>
